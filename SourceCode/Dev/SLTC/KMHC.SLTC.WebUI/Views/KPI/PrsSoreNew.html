<div class="row">
    <div id="content" class="col-lg-12">
        <div class="row">
            <div class="col-sm-12">
                <div class="page-header">
                    <ul class="breadcrumb">
                        <li>
                            <i class="fa fa-home"></i>
                            <a href="/">首页</a>
                        </li>
                        <li>
                            压疮
                        </li>
                    </ul>

                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-12">
                <div class="col-sm-2">
                    <div class="box border primary">
                        <div class="box-title">
                            <h4>
                                <i class="fa fa-bars"></i>住民信息
                            </h4>
                        </div>
                        <div class="box-body">
                            <resident-card feeno={{FeeNo}} callback="residentSelected(resident)" />
                        </div>
                    </div>
                </div>
                <div class="col-sm-10">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="box border primary">
                                <div class="box-title">
                                    <h4><i class="fa fa-bars"></i>压疮详细</h4>
                                </div>
                                <div class="box-body">
                                    <form class="form-horizontal" role="form" name="form1" novalidate>
                                        <div class="panel panel-default">
                                            <div class="panel-heading">发现收案</div>
                                            <div class="panel-body">
                                                <div class="form-group">
                                                    <label class="col-sm-1 control-label" for="selOccurChance">发现时机<span class="required">*</span></label>
                                                    <div class="col-sm-2">
                                                        <select class="form-control" id="selOccurChance" name="Occurchance" ng-model="curItem.Occurchance" select-code="F00.005" required></select>
                                                    </div>

                                                    <label class="col-sm-1 control-label" for="selEvaluteBy" required="true">评估者<span class="required">*</span></label>
                                                    <div class="col-sm-2">
                                                        <input-staff id="selEvaluteBy" callback="staffSelected(item)" value="{{curItem.EvaluteBy}}" />
                                                    </div>

                                                    <label class="col-sm-1 control-label" for="txtOccurDate">发现时间<span class="required">*</span></label>
                                                    <div class="col-sm-2">
                                                        <input id="txtOccurDate" class="form-control datepicker" name="发现时间" ng-model="curItem.OccurDate" required ca-date-time-picker ng-disabled="true" readonly="readonly">
                                                    </div>

                                                    <label class="col-sm-1 control-label" for="selDegree">压疮级别<span class="required">*</span></label>
                                                    <div class="col-sm-2">
                                                        <select class="form-control" id="selDegree" name="压疮级别" ng-model="curItem.Degree" select-code="F00.006" required></select>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="panel panel-default">
                                            <div class="panel-heading">完成治疗</div>
                                            <div class="panel-body">
                                                <div class="form-group">
                                                    <label class="control-label col-sm-1" for="txtInspectionResult">治疗结果</label>
                                                    <div class="col-sm-2">
                                                        <input id="txtInspectionResult" name="治疗结果" class="form-control" ng-model="curItem.InspectionResult" ng-maxlength="50" />
                                                    </div>
                                                    <div class="col-sm-3 control-label" style="text-align: left;">
                                                        <input id="txtRevoceryFalg" class="checkbox-inline" type="checkbox" ng-model="curItem.RevoceryFlag" /><label for="txtRevoceryFalg">本次压疮已结束</label>
                                                    </div>
                                                    <label class="control-label col-sm-1" for="txtRecoveryDate">结束日期</label>
                                                    <div class="col-sm-2">
                                                        <input id="txtRecoveryDate" class="form-control" ng-model="curItem.RevoceryDate" ng-change="checkDate()" ca-date-picker />
                                                    </div>
                                                    <label class="control-label col-sm-1" for="txtRecoveryDesc">结束原因</label>
                                                    <div class="col-sm-2">
                                                        <input id="txtRecoveryDesc" name="结束原因" class="form-control" ng-model="curItem.RevoceryDesc" ng-maxlength="40" />
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label class="control-label col-sm-1" for="txtEventReview">送检结果</label>
                                                    <div class="col-sm-11">
                                                        <textarea id="txtEventReview" name="送检结果" class="form-control" ng-model="curItem.EventreView" ng-maxlength="200"></textarea>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="panel panel-default">
                                            <div class="panel-heading">目前评估与治疗情形记录 &nbsp;&nbsp;&nbsp;&nbsp;<button class="btn btn-primary" ng-show="editDetailShow" ng-click="editDetail({})">新增治疗情形</button></div>
                                            <div class="panel-body">
                                                <div class="panel panel-default">
                                                    <div class="panel-body">
                                                        <ui-data-table options="detailOptions">
                                                            <table class="table table-striped table-bordered table-hover table-handler">
                                                                <thead>
                                                                    <tr>
                                                                        <th>评估时间</th>
                                                                        <th>伤口部位</th>
                                                                        <th>伤口长</th>
                                                                        <th>伤口宽</th>
                                                                        <th>伤口深</th>
                                                                        <th>潜行方向</th>
                                                                        <th>潜行深度</th>
                                                                        <th>伤口颜色</th>
                                                                        <th>周围皮肤状况</th>
                                                                        <th>分泌物颜色</th>
                                                                        <th>分泌物性质</th>
                                                                        <th>分泌物量</th>
                                                                        <th>护理人员</th>
                                                                        <th>换药方式</th>
                                                                        <th>治疗活动</th>

                                                                        <th><i class="fa fa-bars"></i> 操作</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr ng-repeat="item in curItem.Detail">
                                                                        <td>{{item.EcalDate|date:'yyyy-MM-dd HH:mm:ss'}}</td>
                                                                        <td>{{item.WoundPart|codeText:'F00.007'}}</td>
                                                                        <td>{{item.Size_L}}</td>
                                                                        <td>{{item.Size_W}}</td>
                                                                        <td>{{item.Size_D}}</td>
                                                                        <td>{{item.WoundDirection}}</td>
                                                                        <td>{{item.WoundDepth}}</td>
                                                                        <td><span select-code="F00.008" select-value="{{item.WoundColor}}"></span></td>
                                                                        <td><span select-code="F00.009" select-value="{{item.SkinDesc}}"></span></td>
                                                                        <td><span select-code="F00.010" select-value="{{item.SecretionColor}}"></span></td>
                                                                        <td><span select-code="F00.011" select-value="{{item.SecretionNature}}"></span></td>
                                                                        <td>{{item.SecretionAmt}}</td>
                                                                        <td>{{item.NurseName}}</td>
                                                                        <td><span select-code="F00.012" select-value="{{item.Dressing}}">></span></td>
                                                                        <td>{{item.Treatement}}</td>

                                                                        <td>
                                                                            <div class="btn-group btn-group-xs" role="group" aria-label="...">
                                                                                <a class="btn btn-info" role="button" ng-click="editDetail(item)"><i class="fa fa-pencil"></i>编辑</a>
                                                                                <a class="btn btn-primary" role="button" ng-click="delDetail(item)"><i class="fa fa-times"></i>删除</a>
                                                                            </div>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </ui-data-table>
                                                        <div id="pager1" class="pull-right"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="panel panel-default">
                                            <div class="panel-heading">照片</div>
                                            <div class="panel-body">
                                                <div class="form-group">
                                                    <div class="col-sm-5">
                                                        <img class="img-responsive img-fluid" ng-src="{{(curItem.Pict2 != null && curItem.Pict2 != '') ? curItem.Pict2.split(',')[0] : '/Images/0.png'}}" style="height: 130px; vertical-align: central; width: 100%;" />
                                                        <div><div style="padding: 5px;" id="PhothoPathPicker2">选择治疗照片</div></div>
                                                        <div class="form-group" style="padding-left: 5px;">
                                                            <button class="btn btn-primary" ng-click="clear('Pict2')">清除</button>
                                                            <button class="btn btn-primary" data-toggle="modal" data-target="#modalViewPhoto" data-type="curItem.Pict2">
                                                                查看全部治疗照片
                                                            </button>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-5">
                                                        <img class="img-responsive img-fluid" ng-src="{{(curItem.Pict3 != null && curItem.Pict3 != '') ? curItem.Pict3.split(',')[0] : '/Images/0.png'}}" style="height: 130px; vertical-align: central; width: 100%;" />
                                                        <div><div style="padding: 5px;" id="PhothoPathPicker3">选择结案照片</div></div>
                                                        <div class="form-group" style="padding-left: 5px;">
                                                            <button class="btn btn-primary" ng-click="clear('Pict3')">清除</button>
                                                            <button class="btn btn-primary" data-toggle="modal" data-target="#modalViewPhoto" data-type="curItem.Pict3">
                                                                查看全部结案照片
                                                            </button>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-2">
                                                        <div style="height: 130px; vertical-align: central; width: 100%;"><a ng-href="{{curItem.SavedLocation}}" target="_blank">{{curItem.FileName != null ? curItem.FileName :""}}</a></div>
                                                        <div><div id="ArchiveFilePicker">选择文件</div></div>
                                                        <button class="btn btn-primary" ng-click="clear('Pict4')">清除</button>
                                                    </div>
                                                </div>

                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <div class="col-sm-12 text-center">
                                                <button class="btn btn-primary" ng-show="editShow" ng-click="save()" ng-disabled="form1.$invalid">保存</button>
                                                <button class="btn btn-primary" ng-show="editShow" ng-click="reset()">重置</button>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="box border primary">
                                <div class="box-title">
                                    <h4><i class="fa fa-table"></i>压疮列表</h4>
                                </div>
                                <div class="box-body">
                                    <div class="panel panel-default">
                                        <div class="panel-body">
                                            <ui-data-table options="options">
                                                <table class="table table-striped table-bordered table-hover table-handler">
                                                    <thead>
                                                        <tr>
                                                            <th>发现日期</th>
                                                            <th>压疮级别</th>
                                                            <th>评估者</th>
                                                            <th>治疗结果</th>
                                                            <th>是否恢复</th>
                                                            <th><i class="fa fa-bars"></i> 操作</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr ng-repeat="item in prsSoreList" ng-class="{true: 'ng-scope active', false: 'ng-scope'}[item.Seq==curItem.Seq]">
                                                            <td>{{item.OccurDate|date:'yyyy-MM-dd'}}</td>
                                                            <td>{{item.Degree | codeText:'F00.006'}}</td>
                                                            <td>{{item.EvaluteNameBy}}</td>
                                                            <td>{{item.InspectionResult}}</td>
                                                            <td>{{item.RevoceryFlag?"是":"否"}}</td>
                                                            <td>
                                                                <div class="btn-group btn-group-xs" role="group" aria-label="...">
                                                                    <a id="a{{item.Seq}}" class="btn btn-info" role="button" ng-click="edit(item)"><i class="fa fa-pencil"></i>编辑</a>
                                                                    <a class="btn btn-primary" role="button" ng-click="delete(item.Seq)"><i class="fa fa-times"></i>删除</a>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </ui-data-table>
                                            <div id="pager" class="pull-right"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modalDetail" tabindex="-1" role="dialog" aria-labelledby="modalDetailLabel" data-target=".bs-example-modal-lg">
    <div class="modal-dialog bs-example-modal-lg" role="document" style="width: 85%">
        <div class="modal-content modal-lg">
            <div class="modal-header bg-success">
                <button type="button" id="billClose" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">
                    目前点选的评估与治疗情形
                </h4>
            </div>
            <div class="modal-body">
                <form class="form-horizontal" role="form" name="form2" novalidate>
                    <div class="row">
                        <div class="col-sm-10">
                            <div class="form-group">
                                <label class="col-sm-1 control-label" for="selWoundPart">伤口部位</label>
                                <div class="col-sm-3">
                                    <input type="text" id="txtWoundPart" class="form-control" ng-model="curDelItem.WoundPart" select-multiple-code="F00.007" />
                                    <!--<select class="form-control" id="selWoundPart" name="WoundPart" ng-model="curDelItem.WoundPart" select-code="F00.007"></select>-->
                                </div>

                                <label class="col-sm-1 control-label">本次评估等级</label>
                                <div class="col-sm-3">
                                    <select class="form-control" name="Degree" ng-model="curDelItem.Degree" select-code="F00.006"></select>
                                </div>

                                <label class="col-sm-1 control-label">评估时间</label>
                                <div class="col-sm-3">
                                    <input id="txt_HospName" name="txtEcalDate" ng-model="curDelItem.EcalDate" class="form-control" required ca-date-time-picker />
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-1 control-label" for="txtSize_L">伤口大小(cm)</label>
                                <div class="col-sm-3">
                                    <input type="number" ng-pattern="/^[1-9]\d*$/" id="txtSize_L" name="Size_L" ng-model="curDelItem.Size_L" class="form-control" ng-maxlength="10" style="width: 31%; display: inline-block" />
                                    <input type="number" ng-pattern="/^[1-9]\d*$/" id="txtSize_W" name="Size_W" ng-model="curDelItem.Size_W" class="form-control" ng-maxlength="10" style="width: 31%; display: inline-block" />
                                    <input type="number" ng-pattern="/^[1-9]\d*$/" id="txtSize_D" name="Size_D" ng-model="curDelItem.Size_D" class="form-control" ng-maxlength="10" style="width: 31%; display: inline-block" />
                                </div>
                                <label class="col-sm-1 control-label" for="txtWoundDirection">潜行方向</label>
                                <div class="col-sm-3">
                                    <input id="txtWoundDirection" name="潜行方向" class="form-control" ng-model="curDelItem.WoundDirection" ng-maxlength="10" />
                                </div>
                                <label class="col-sm-1 control-label" for="txtWoundDepth">潜行深度</label>
                                <div class="col-sm-3">
                                    <div class="input-group">
                                        <input type="number" ng-pattern="/^[1-9]\d*$/" id="txtWoundDepth" class="form-control" name="潜行深度" ng-model="curDelItem.WoundDepth" ng-maxlength="10" />
                                        <span class="input-group-addon">cm</span>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-1 control-label" for="txtWoundColor">伤口颜色</label>
                                <div class="col-sm-3">
                                    <select id="txtWoundColor" class="form-control" ng-model="curDelItem.WoundColor" select-code="F00.008"></select>
                                </div>
                                <label class="col-sm-1 control-label" for="txtSkinDesc">周围皮肤状况</label>
                                <div class="col-sm-3">
                                    <select class="form-control" id="txtSkinDesc" ng-model="curDelItem.SkinDesc" select-code="F00.009"></select>
                                </div>
                                <label class="col-sm-1 control-label" for="txtSecretionColor">分泌物颜色</label>
                                <div class="col-sm-3">
                                    <select id="txtSecretionColor" name="SecretionColor" ng-model="curDelItem.SecretionColor" select-code="F00.010" class="form-control"></select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-1 control-label" for="txtSecretionNature">分泌物性质</label>
                                <div class="col-sm-3">
                                    <select id="txtSecretionNature" name="SecretionNature" ng-model="curDelItem.SecretionNature" select-code="F00.011" class="form-control"></select>
                                </div>

                                <label class="col-sm-1 control-label" for="txtSecretionAmt">纱布渗液范围</label>
                                <div class="col-sm-3">
                                    <div class="input-group">
                                        <input type="number" ng-pattern="/^[1-9]\d*$/" id="txtSecretionAmt" name="纱布渗液范围" class="form-control" ng-model="curDelItem.SecretionAmt" ng-maxlength="20" />
                                        <span class="input-group-addon">cm</span>
                                    </div>
                                </div>
                                <label class="col-sm-1 control-label">护理人员</label>
                                <div class="col-sm-3">
                                    <input-staff callback="staffSelected(item,1)" value="{{curDelItem.Nurse}}" />
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-1 control-label" for="txtDressing">换药方式</label>
                                <div class="col-sm-5">
                                    <select id="txtDressing" name="换药方式" ng-model="curDelItem.Dressing" class="form-control" select-code="F00.012"></select>
                                </div>
                                <label class="col-sm-1 control-label">治疗活动</label>
                                <div class="col-sm-5">
                                    <input id="txtTreateMent" name="治疗活动" class="form-control" ng-model="curDelItem.Treatement" ng-maxlength="200" />
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-2">
                            <img class="img-responsive img-fluid" ng-src="{{(curDelItem.Picture != null && curDelItem.Picture != '') ? curDelItem.Picture.split(',')[0] : '/Images/0.png'}}" style="height:130px; vertical-align:central;width:100%; " />
                            <div class="text-center" style="margin-top:5px;width:100%;">
                                <div class="col-sm-7 form-group"><div id="WoundPathPicker">选择图片</div></div>
                                <div class="col-sm-5 form-group">
                                    <button class="btn btn-primary" ng-click="clear('Picture')">清除</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-sm-12 text-center">
                            <button class="btn btn-primary" ng-click="saveDetail()">保存</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="modalViewPhoto" tabindex="-1" role="dialog" aria-labelledby="modalPhotoLabel" data-target=".bs-example-modal-lg">
    <div class="modal-dialog bs-example-modal-lg" role="document" style="width: 80%">
        <div class="modal-content modal-lg">
            <div class="modal-header bg-success">
                <button type="button" id="billClose1" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel1">
                    图片清单
                </h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-12">
                        <div class="box">
                            <div class="box-body clearfix">
                                <div class="row isotope" id="filter-items">
                                    <div class="col-md-3 isotope-item" ng-repeat="item in viewPhotos track by $index">
                                        <div class="filter-content">
                                            <img class="img-responsive" alt="" ng-src="{{item}}" style="height:200px;" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


