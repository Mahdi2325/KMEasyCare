<div class="row">
    <div id="content" class="col-lg-12">
        <!--标题-->
        <div class="row">
            <div class="col-sm-12">
                <div class="page-header">
                    <ul class="breadcrumb">
                        <li>
                            <i class="fa fa-home"></i>
                            <a href="/">首页</a>
                        </li>
                        <li>指标管理</li>
                    </ul>
                    
                </div>
            </div>
        </div>
        <!--标题-->

        <div class="row">
            <div class="col-sm-2">
                <div class="box border primary">
                    <div class="box-title">
                        <h4>
                            <i class="fa fa-bars"></i>住民信息
                        </h4>
                    </div>
                    <div class="box-body">
                        <resident-card feeno={{FeeNo}} callback="residentSelected(resident)" />
                    </div>
                </div>
            </div>
            <div class="col-sm-10">
                <div class="box border primary">
                    <div class="box-title">
                        <h4>压疮情况</h4>
                    </div>
                    <div class="box-body">
                        <div class="tabbable header-tabs">
                            <ul class="nav nav-tabs" id="tabResident">
                                <li><a href="#AttachPhoto" href="" data-toggle="tab"><i class="fa fa-circle-o"></i> <span class="hidden-inline-mobile">附加文件</span></a></li>
                                <li><a href="#OverPhoto" href="" data-toggle="tab"><i class="fa fa-circle-o"></i> <span class="hidden-inline-mobile">结案照片</span></a></li>
                                <li><a href="#CurePhoto" href="" data-toggle="tab"><i class="fa fa-circle-o"></i> <span class="hidden-inline-mobile">治疗照片</span></a></li>
                                <!--<li><a href="#SpotPhoto" href="" data-toggle="tab"><i class="fa fa-circle-o"></i> <span class="hidden-inline-mobile">压疮发现时情形/照片</span></a></li>-->
                                <li class="active"><a href="#SituationInfo" href="" data-toggle="tab"><i class="fa fa-book"></i> <span class="hidden-inline-mobile">压疮情形</span></a></li>
                            </ul>
                            <div class="tab-content" style="padding: 10px">
                                <div id="SituationInfo" class="tab-pane active">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <div class="pull-right">
                                                <div class="btn-group btn-large">
                                                    <button type="button" class="btn btn-info" data-toggle="modal" data-target="#modalAll" ng-click="searchAll()">查看所有记录</button>
                                                    <button type="button" class="btn btn-info" ng-click="mEditOrAdd('add')">新增主文档</button>
                                                    <button type="button" class="btn btn-info" ng-click="mEditOrAdd('edit')">保存主文档</button>
                                                    <button type="button" class="btn btn-info" ng-click="init()">清空当前文档</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-12">
                                            <fieldset>
                                                <legend>发现收案</legend>
                                                <div class="well form-horizontal">
                                                    <div class="form-group">
                                                        <label class="col-sm-1 control-label" for="selOccurChance">发现时机<span class="required">*</span></label>
                                                        <div class="col-sm-2">
                                                            <select class="form-control" id="selOccurChance" name="Occurchance" ng-model="curItem.Occurchance" select-code="F00.005" required></select>
                                                        </div>

                                                        <label class="col-sm-1 control-label" for="selEvaluteBy" required="true">评估者<span class="required">*</span></label>
                                                        <div class="col-sm-2">
                                                            <input-staff id="selEvaluteBy" callback="staffSelected(item)" value="{{curItem.EvaluteBy}}" />
                                                        </div>

                                                        <label class="col-sm-1 control-label" for="txtOccurDate">发现时间<span class="required">*</span></label>
                                                        <div class="col-sm-2">
                                                            <input id="txtOccurDate" class="form-control datepicker" name="OccurDate" ng-model="curItem.OccurDate" required ca-date-time-picker readonly="readonly">
                                                        </div>

                                                        <label class="col-sm-1 control-label" for="selDegree">压疮级别<span class="required">*</span></label>
                                                        <div class="col-sm-2">
                                                            <select class="form-control" id="selDegree" name="Degree" ng-model="curItem.Degree" select-code="F00.006" required></select>
                                                        </div>
                                                    </div>
                                                </div>
                                            </fieldset>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <form class="form-horizontal" role="form" name="vitalfrom">
                                                <fieldset>
                                                    <legend>目前点选的评估治疗情形</legend>
                                                    <div class="well">
                                                        <div class="row">
                                                            <div class="col-sm-10">
                                                                <div class="form-group">
                                                                    <label class="col-sm-1 control-label" for="selWoundPart">伤口部位</label>
                                                                    <div class="col-sm-3">
                                                                        <input type="text" id="txtWoundPart" class="form-control" ng-model="curDelItem.WoundPart" select-multiple-code="F00.007" />
                                                                        <!--<select class="form-control" id="selWoundPart" name="WoundPart" ng-model="curDelItem.WoundPart" select-code="F00.007"></select>-->
                                                                    </div>

                                                                    <label class="col-sm-1 control-label">本次评估等级</label>
                                                                    <div class="col-sm-3">
                                                                        <select  class="form-control" name="Degree" ng-model="curDelItem.Degree" select-code="F00.006" ></select>
                                                                    </div>

                                                                    <label class="col-sm-1 control-label">评估时间</label>
                                                                    <div class="col-sm-3">
                                                                        <input id="txt_HospName" name="txtEcalDate" ng-model="curDelItem.EcalDate" class="form-control" ca-date-time-picker readonly />
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <label class="col-sm-1 control-label" for="txtSize_L">伤口大小</label>
                                                                    <div class="col-sm-3">
                                                                        <input id="txtSize_L" name="Size_L" ng-model="curDelItem.Size_L" class="form-control" style="width:31%;display:inline-block" ng-maxlength="10" />
                                                                        <input id="txtSize_W" name="Size_W" ng-model="curDelItem.Size_W" class="form-control" style="width:31%; display: inline-block" ng-maxlength="10" />
                                                                        <input id="txtSize_D" name="Size_D" ng-model="curDelItem.Size_D" class="form-control" style="width:31%; display: inline-block" ng-maxlength="10" />
                                                                    </div>
                                                                    <label class="col-sm-1 control-label" for="txtWoundDirection">潜行方向</label>
                                                                    <div class="col-sm-3">
                                                                        <input id="txtWoundDirection" name="WoundDirection" class="form-control" ng-model="curDelItem.WoundDirection" ng-maxlength="10"/>
                                                                    </div>
                                                                    <label class="col-sm-1 control-label" for="txtWoundDepth" ng-maxlength="10">潜行深度</label>
                                                                    <div class="col-sm-3">
                                                                        <input id="txtWoundDepth" class="form-control" name="WoundDepth" ng-model="curDelItem.WoundDepth"/>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <label class="col-sm-1 control-label" for="txtWoundColor">伤口颜色</label>
                                                                    <div class="col-sm-3">
                                                                        <select id="txtWoundColor" class="form-control" ng-model="curDelItem.WoundColor" select-code="F00.008"></select>
                                                                    </div>
                                                                    <label class="col-sm-1 control-label" for="txtSkinDesc">周围皮肤状况</label>
                                                                    <div class="col-sm-3">
                                                                        <select class="form-control" id="txtSkinDesc" ng-model="curDelItem.SkinDesc" select-code="F00.009"></select>
                                                                    </div>
                                                                    <label class="col-sm-1 control-label" for="txtSecretionColor">分泌物颜色</label>
                                                                    <div class="col-sm-3">
                                                                        <select id="txtSecretionColor" name="SecretionColor" ng-model="curDelItem.SecretionColor" select-code="F00.010" class="form-control"></select>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <label class="col-sm-1 control-label" for="txtSecretionNature">分泌物性质</label>
                                                                    <div class="col-sm-3">
                                                                        <select id="txtSecretionNature" name="SecretionNature" ng-model="curDelItem.SecretionNature" select-code="F00.011" class="form-control"></select>
                                                                    </div>

                                                                    <label class="col-sm-1 control-label" for="txtSecretionAmt">纱布渗液范围</label>
                                                                    <div class="col-sm-3">
                                                                        <input id="txtSecretionAmt" name="SecretionAmt" class="form-control" ng-model="curDelItem.SecretionAmt" ng-maxlength="20"/>
                                                                    </div>
                                                                    <label class="col-sm-1 control-label">护理人员</label>
                                                                    <div class="col-sm-3">
                                                                        <input-staff callback="staffSelected(item,1)" value="{{curDelItem.Nurse}}"/>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <label class="col-sm-1 control-label" for="txtDressing">换药方式</label>
                                                                    <div class="col-sm-5">
                                                                        <select id="txtDressing" name="Dressing" ng-model="curDelItem.Dressing" class="form-control" select-code="F00.012"></select>
                                                                    </div>
                                                                    <label class="col-sm-1 control-label">治疗活动</label>
                                                                    <div class="col-sm-5">
                                                                        <input id="txtTreateMent" name="Treatement" class="form-control" ng-model="curDelItem.Treatement" ng-maxlength="200" />
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-sm-2">
                                                                <img class="img-responsive img-fluid" ng-src="{{(curDelItem.Picture != null && curDelItem.Picture != '') ? curDelItem.Picture.split(',')[0] : '/Images/0.png'}}" style="height:130px; vertical-align:central;width:100%; " />
                                                                <div class="text-center" style="margin-top:5px;width:100%;">
                                                                    <div class="col-sm-7" id="WoundPathPicker">选择图片</div>
                                                                    <div class="col-sm-5 form-group">
                                                                        <button class="btn btn-primary" ng-click="clear('Picture')">清除</button>
                                                                        <button class="btn btn-primary" data-toggle="modal" data-target="#modalViewPhoto" data-type="curDelItem.Picture">
                                                                            查看图片
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </fieldset>
                                                <div class="form-group">
                                                    <div class="col-sm-12 text-center">
                                                        <button class="btn btn-primary" ng-show="!isAdd" ng-click="dEditOrAdd()">保存</button>
                                                        <button class="btn btn-primary" ng-show="isAdd" ng-click="dEditOrAdd()">新增</button>
                                                        <button class="btn btn-primary" ng-click="initDel()">重置</button>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-12">

                                            <table class="table table-striped table-bordered table-hover table-handler">
                                                <thead>
                                                    <tr>
                                                        <th>评估时间</th>
                                                        <th>伤口部位</th>
                                                        <th>伤口长</th>
                                                        <th>伤口宽</th>
                                                        <th>伤口深</th>
                                                        <th>潜行方向</th>
                                                        <th>潜行深度</th>
                                                        <th>伤口颜色</th>
                                                        <th>周围皮肤状况</th>
                                                        <th>分泌物颜色</th>
                                                        <th>分泌物性质</th>
                                                        <th>分泌物量</th>
                                                        <th>护理人员</th>
                                                        <th>换药方式</th>
                                                        <th>治疗活动</th>
                                                        <!--<th>图片</th>-->
                                                        <th><i class="fa fa-bars"></i> 操作</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr ng-repeat="item in curItem.Detail">
                                                        <td>{{item.EcalDate|date:'yyyy-MM-dd HH:mm:ss'}}</td>
                                                        <td>{{item.WoundPart|codeText:'F00.007'}}</td>
                                                        <td>{{item.Size_L}}</td>
                                                        <td>{{item.Size_W}}</td>
                                                        <td>{{item.Size_D}}</td>
                                                        <td>{{item.WoundDirection}}</td>
                                                        <td>{{item.WoundDepth}}</td>
                                                        <td><span select-code="F00.008" select-value="{{item.WoundColor}}"></span></td>
                                                        <td><span select-code="F00.009" select-value="{{item.SkinDesc}}"></span></td>
                                                        <td><span select-code="F00.010" select-value="{{item.SecretionColor}}"></span></td>
                                                        <td><span select-code="F00.011" select-value="{{item.SecretionNature}}"></span></td>
                                                        <td>{{item.SecretionAmt}}</td>
                                                        <td>{{item.Nurse}}</td>
                                                        <td><span select-code="F00.012" select-value="{{item.Dressing}}">></span></td>
                                                        <td>{{item.Treatement}}</td>
                                                        <!--<td><img src="{{item.Picture}}" style="max-width:20px;max-height:20px;" /></td>-->
                                                        <td>
                                                            <div class="btn-group btn-group-xs" role="group" aria-label="...">
                                                                <!--<a class="btn btn-primary" role="button" data-toggle="modal" data-target="#modalViewPhoto" data-type="curItem.Detail[$index].Picture"><i class="fa fa-camera"></i>图片</a>-->
                                                                <a class="btn btn-info" role="button" ng-click="editOrCreate(item)" data-toggle="modal" data-target="#modalDetail"><i class="fa fa-pencil"></i>编辑</a>
                                                                <a class="btn btn-primary" role="button" ng-click="deleteItem(item)"><i class="fa fa-times"></i>删除</a>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                     
                                    <div class="row">
                                        <fieldset>
                                            <legend>完成治疗</legend>
                                            <div class="form-horizontal">
                                                <div class="form-group">
                                                    <label class="control-label col-sm-1" for="txtInspectionResult">送检结果</label>
                                                    <div class="col-sm-2">
                                                        <input id="txtInspectionResult" class="form-control" ng-model="curItem.InspectionResult" ng-maxlength="50" />
                                                    </div>
                                                    <div class="col-sm-2 control-label" style="text-align:left;">
                                                        <input id="txtRevoceryFalg" class="checkbox-inline" type="checkbox" ng-model="curItem.RecoveryFalg" /><label for="txtRevoceryFalg">本次压疮已结束</label>
                                                    </div>
                                                    <label class="control-label col-sm-1" for="txtRecoveryDate">结束日期</label>
                                                    <div class="col-sm-2">
                                                        <input id="txtRecoveryDate" class="form-control" ng-model="curItem.RecoveryDate" ca-date-picker  />
                                                    </div>
                                                    <label class="control-label col-sm-1" for="txtRecoveryDesc">结束原因</label>
                                                    <div class="col-sm-2">
                                                        <input id="txtRecoveryDesc" class="form-control" ng-model="curItem.RecoveryDesc" ng-maxlength="40" />
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label class="control-label col-sm-1" for="txtEventReview">送检结果</label>
                                                    <div class="col-sm-11">
                                                        <textarea id="txtEventReview" class="form-control" ng-model="curItem.EventReview" ng-maxlength="200"></textarea>
                                                    </div>

                                                </div>
                                            </div>
                                        </fieldset>
                                    </div>
                                </div>
                                <div id="SpotPhoto" class="tab-pane ">
                                    <div class="form-horizontal">
                                        <div class="form-group">
                                            <div class="col-sm-6">
                                                <img src="{{curItem.Pict1}}" />
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <div class="col-sm-2">
                                                <div id="PhothoPathPicker1">选择图片</div>
                                            </div>
                                            <div class="col-sm-4">
                                                <button class="btn btn-primary" ng-click="clear('Pict1')">清除</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="CurePhoto" class="tab-pane ">
                                    <div class="form-horizontal">
                                        <div class="form-group">
                                            <div class="col-sm-6">
                                                <img src="{{curItem.Pict2}}" />
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <div class="col-sm-2">
                                                <div id="PhothoPathPicker2">选择图片</div>
                                            </div>
                                            <div class="col-sm-4">
                                                <button class="btn btn-primary" ng-click="clear('Pict2')">清除</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="OverPhoto" class="tab-pane ">
                                    <div class="form-horizontal">
                                        <div class="form-group">
                                            <div class="col-sm-6">
                                                <img src="{{curItem.Pict3}}" />
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <div class="col-sm-2">
                                                <div id="PhothoPathPicker3">选择图片</div>
                                            </div>
                                            <div class="col-sm-4">
                                                <button class="btn btn-primary" ng-click="clear('Pict3')">清除</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="AttachPhoto" class="tab-pane ">
                                    <div class="form-horizontal">
                                        <div class="form-group">
                                            <label class="col-sm-2 control-label">压疮附加文件</label>
                                            <div class="col-sm-2">
                                                <div id="ArchiveFilePicker">选择文件</div>
                                            </div>
                                            <div class="col-sm-3">
                                                <button class="btn btn-primary" ng-click="clear('Pict4')">清除</button>
                                            </div>
                                            <a class="col-sm-3" ng-href="{{curItem.Pict4}}" target="_blank">{{curItem.Pict4 != null ? "下载附加文件":""}}</a>
                                            <div class="col-sm-2">
                                                （限Word档）
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modalAll" tabindex="-1" role="dialog" aria-labelledby="modalBedLabel" data-target=".bs-example-modal-lg">
    <div class="modal-dialog bs-example-modal-lg" role="document" style="width: 80%">
        <div class="modal-content modal-lg">
            <div class="modal-header bg-success">
                <button type="button" id="billClose" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">
                    治疗情况详细
                </h4>
            </div>
            <div class="modal-body">
                <table class="table table-striped table-bordered table-hover table-handler">
                    <thead>
                    <tr>
                        <th>发现日期</th>
                        <th>压疮级别</th>
                        <th>评估者</th>
                        <th>治疗结果</th>
                        <th>是否恢复</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr ng-repeat="item in prsSoreList" ng-click="modify(item)">
                        <td>{{item.OccurDate|date:'yyyy-MM-dd'}}</td>
                        <td><span select-code="F00.006" select-value="{{item.Degree}}"></span></td>
                        <td>{{item.EvaluteBy}}</td>
                        <td>{{item.InspectionResult}}</td>
                        <td>{{item.RecoveryFalg?"是":"否"}}</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="modalViewPhoto" tabindex="-1" role="dialog" aria-labelledby="modalPhotoLabel" data-target=".bs-example-modal-lg">
    <div class="modal-dialog bs-example-modal-lg" role="document" style="width: 80%">
        <div class="modal-content modal-lg">
            <div class="modal-header bg-success">
                <button type="button" id="billClose1" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel1">
                    图片列表
                </h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-12">
                        <!-- BOX -->
                        <div class="box">
                            <div class="box-body clearfix">
                                <div class="row isotope" id="filter-items">
                                    <div class="col-md-3 isotope-item" ng-repeat="item in viewPhotos track by $index">
                                        <div class="filter-content">
                                            <img class="img-responsive" alt="" ng-src="{{item}}" style="height:200px;"/>
                                        </div>
                                    </div>
                               </div>
                            </div>
                        </div>
                        <!-- /BOX -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


