<!--转介-->

<div class="row">
    <div id="content" class="col-md-12">
        <div class="row">
            <div class="col-sm-12">
                <div class="page-header">
                    <!-- BREADCRUMBS -->
                    <ul class="breadcrumb">
                        <li>
                            <i class="fa fa-home"></i>
                            <a href="/">首页</a>
                        </li>

                        <li>社工转介记录</li>
                    </ul>
                    <!-- /BREADCRUMBS -->
                    <!--<div class="clearfix"></div>
                    -->
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-12">
                <div class="col-sm-2">
                    <div class="box border primary">
                        <div class="box-title">
                            <h4>
                                <i class="fa fa-bars"></i>住民信息
                            </h4>
                        </div>
                        <div class="box-body">
                            <resident-card feeno={{FeeNo}} callback="residentSelected(resident)" />
                        </div>
                    </div>
                </div>
                <div class="col-md-10">
                    <div class="box border primary">
                        <div class="box-title">
                            <h4><i class="fa fa-columns"></i>转介记录管理视窗</h4>
                        </div>
                        <div class="box-body">
                            <form class="form-horizontal" name="rfrForm" role="form" novalidate>
                                <div class="form-group">
                                    <label for="selRecordBy" class="col-sm-1 control-label">个管员<span class="required">*</span></label>
                                    <div class="col-sm-2">
                                        <!--<select class="form-control" id="selNextEvaluator" ng-model="currentItem.EmpNo" ng-options="t.EmpNo as t.EmpName for t in Data.EmpList" default-first="true" required>

                                        </select>-->
                                        <input-staff callback="staffSelected(item)" value="{{currentItem.EmpNo}}" name="个管员" required=true />
                                    </div>
                                    <label for="dtRecDate" class="col-sm-1 control-label">转介日期<span class="required">*</span></label>
                                    <div class="col-sm-2">
                                        <input type="text" class="form-control" ca-date-picker id="dtRecDate" ng-model="currentItem.RecDate" name="转介日期" required>
                                    </div>
                                    <label for="dtContactDate" class="col-sm-1 control-label">转介原因<span class="required">*</span></label>
                                    <div class="col-sm-5">
                                        <!--<select class="form-control" id="selReason" ng-model="currentItem.Reason" ng-options="Reason.value as Reason.text for Reason in Data.Reason">
                                            <option value="">-- 请选择 --</option>
                                        </select>-->
                                        <input type="text" class="form-control" id="txtUnitTel" ng-model="currentItem.Reason" select-items="转介原因" name="转介原因" required>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="txtUnitName" class="col-sm-1 control-label">受理转介单位<span class="required">*</span></label>
                                    <div class="col-sm-2">
                                        <input type="text" class="form-control" id="txtUnitName" ng-model="currentItem.UnitName" name="受理转介单位" ng-maxlength="80" required>
                                    </div>
                                    <label for="txtUnitContactor" class="col-sm-1 control-label">受理单位联系人<span class="required">*</span></label>
                                    <div class="col-sm-2">
                                        <input type="text" class="form-control" id="txtUnitContactor" ng-model="currentItem.UnitContactor" ng-maxlength="20" name="受理单位联系人" required>
                                    </div>
                                    <label for="txtUnitAddress" class="col-sm-1 control-label">受理单位地址</label>
                                    <div class="col-sm-2">
                                        <input type="text" class="form-control" id="txtUnitAddress" ng-maxlength="80" ng-model="currentItem.UnitAddress">
                                    </div>
                                    <label for="txtUnitTel" class="col-sm-1 control-label">受理单位电话<span class="required">*</span></label>
                                    <div class="col-sm-2">
                                        <input type="text" class="form-control" id="txtUnitTel" ng-model="currentItem.UnitTel" name="受理单位电话" ng-maxlength="30" phone required>
                                    </div>
                                </div>


                                <div class="form-group">
                                    <label class="control-label col-md-1">问题摘要</label>
                                    <div class="col-md-11">
                                        <textarea class="form-control" rows="3" ng-maxlength="200" ng-model="currentItem.QuestionSummary" select-items="问题摘要"></textarea>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-md-1">服务摘要</label>
                                    <div class="col-md-11">
                                        <textarea class="form-control" rows="3" ng-maxlength="200" ng-model="currentItem.ServiceSummary" select-items="服务摘要"></textarea>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-md-1">服务建议</label>
                                    <div class="col-md-11">
                                        <textarea class="form-control" rows="3" ng-maxlength="200" ng-model="currentItem.Suggestion" select-items="服务建议"></textarea>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-md-1">回复情形</label>
                                    <div class="col-md-11">
                                        <textarea class="form-control" rows="3" ng-maxlength="200" ng-model="currentItem.ReplyDesc"></textarea>
                                    </div>
                                </div>
                                <div class="form-group">

                                    <label for="dtReplyDate" class="col-sm-1 control-label">回复日期<span class="required">*</span></label>
                                    <div class="col-sm-2">
                                        <input type="text" class="form-control" ca-date-picker id="dtReplyDate" ng-model="currentItem.ReplyDate" name="回复日期" required>
                                    </div>
                                    <label for="dtContactDate" class="col-sm-1 control-label">回复方式<span class="required">*</span></label>
                                    <div class="col-sm-2">
                                        <select class="form-control" id="selReplyType" ng-model="currentItem.ReplyType" select-code="E00.214" name="回复方式" required>
                                            <option value="">-- 请选择 --</option>
                                        </select>
                                    </div>

                                    <div class="col-sm-6">
                                    </div>
                                </div>
                                <div class="form-group">

                                    <div class="pull-right">
                                        <div class="btn-group btn-group-sm" role="group" aria-label="...">
                                            <button class="btn btn-primary" ng-disabled="rfrForm.$invalid" ng-click="saveReferral(currentItem)">保存</button>&nbsp;
                                            <button type="button" class="btn btn-default" ng-click="cancelEdit()">取消</button>
                                        </div>

                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div class="box border primary">
                        <div class="box-title">
                            <h4><i class="fa fa-table"></i>转介历次记录</h4>
                        </div>
                        <div class="box-body  col-md-12">
                            <ui-data-table options="options">
                                <table id="tbEvalList" class="table table-striped table-bordered table-hover table-handler">
                                    <thead>
                                        <tr>
                                            <th class="col-md-1">转介日期</th>
                                            <th class="col-md-1">个案管理员</th>
                                            <th class="col-md-1">转介原因</th>
                                            <th class="col-md-1">受理转介单位</th>
                                            <th class="col-md-1">受理单位联系人</th>
                                            <th class="col-md-1">受理单位电话</th>
                                            <th class="col-md-2">问题摘要</th>
                                            <th class="col-md-1">服务摘要</th>
                                            <th class="col-md-2">服务建议</th>
                                            <th class="col-md-1"><i class="fa fa-bars"></i> 操作</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="referralRec in referralRecs">
                                            <td>{{referralRec.RecDate | dateFormat}}</td>
                                            <td>{{referralRec.EmpName}}</td>
                                            <td style="word-break: break-all; word-wrap: break-word;">{{referralRec.Reason}}</td>
                                            <td style="word-break: break-all; word-wrap: break-word;">{{referralRec.UnitName}}</td>
                                            <td style="word-break: break-all; word-wrap: break-word;">{{referralRec.UnitContactor}}</td>
                                            <td>{{referralRec.UnitTel}}</td>
                                            <td style="word-break: break-all; word-wrap: break-word;">{{referralRec.QuestionSummary}}</td>
                                            <td style="word-break: break-all; word-wrap: break-word;">{{referralRec.ServiceSummary}}</td>
                                            <td style="word-break: break-all; word-wrap: break-word;">{{referralRec.Suggestion}}</td>
                                            <td>
                                                <div class="btn-group btn-group-xs" role="group" aria-label="...">

                                                    <button class="btn btn-info" ng-click="openWin(referralRec)"><i class="fa fa-pencil">编辑</i></button>

                                                    <a class="btn btn-primary" role="button" data-toggle="modal" ng-click="deleteItem(referralRec)"><i class="fa fa-times">删除</i></a>

                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>

                                </table>
                            </ui-data-table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    $(".datepicker").datepicker({
        dateFormat: "yy-mm-dd",
        changeMonth: true,
        changeYear: true
    });
</script>
